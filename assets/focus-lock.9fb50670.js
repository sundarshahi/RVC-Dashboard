var P="data-focus-lock",V="data-focus-lock-disabled",R="data-no-focus-lock",H="data-autofocus-inside",m=function(r){for(var e=Array(r.length),n=0;n<r.length;++n)e[n]=r[n];return e},I=function(r){return Array.isArray(r)?r:[r]},K=function(r){for(var e=new Set,n=r.length,t=0;t<n;t+=1)for(var a=t+1;a<n;a+=1){var o=r[t].compareDocumentPosition(r[a]);(o&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&e.add(a),(o&Node.DOCUMENT_POSITION_CONTAINS)>0&&e.add(t)}return r.filter(function(u,i){return!e.has(i)})},w=function(r){return r.parentNode?w(r.parentNode):r},E=function(r){var e=I(r);return e.filter(Boolean).reduce(function(n,t){var a=t.getAttribute(P);return n.push.apply(n,a?K(m(w(t).querySelectorAll("["+P+'="'+a+'"]:not(['+V+'="disabled"])'))):[t]),n},[])},Y=function(r){if(r.nodeType!==Node.ELEMENT_NODE)return!1;var e=window.getComputedStyle(r,null);return!e||!e.getPropertyValue?!1:e.getPropertyValue("display")==="none"||e.getPropertyValue("visibility")==="hidden"},z=function(r,e){return!r||r===document||r&&r.nodeType===Node.DOCUMENT_NODE||!Y(r)&&e(r.parentNode&&r.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r.parentNode.host:r.parentNode)},B=function(r,e){var n=r.get(e);if(n!==void 0)return n;var t=z(e,B.bind(void 0,r));return r.set(e,t),t},J=function(r){return!((r.tagName==="INPUT"||r.tagName==="BUTTON")&&(r.type==="hidden"||r.disabled))},A=function(r){return Boolean(r&&r.dataset&&r.dataset.focusGuard)},p=function(r){return!A(r)},Q=function(r){return Boolean(r)},X=function(r,e){var n=r.tabIndex-e.tabIndex,t=r.index-e.index;if(n){if(!r.tabIndex)return 1;if(!e.tabIndex)return-1}return n||t},k=function(r,e,n){return m(r).map(function(t,a){return{node:t,index:a,tabIndex:n&&t.tabIndex===-1?(t.dataset||{}).focusGuard?0:-1:t.tabIndex}}).filter(function(t){return!e||t.tabIndex>=0}).sort(X)},Z=["button:enabled","select:enabled","textarea:enabled","input:enabled","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[tabindex]","[contenteditable]","[autofocus]"],h=Z.join(","),$=h+", [data-focus-guard]",T=function(r,e){return r.reduce(function(n,t){return n.concat(m(t.querySelectorAll(e?$:h)),t.parentNode?m(t.parentNode.querySelectorAll(h)).filter(function(a){return a===t}):[])},[])},j=function(r){var e=r.querySelectorAll("["+H+"]");return m(e).map(function(n){return T([n])}).reduce(function(n,t){return n.concat(t)},[])},F=function(r,e){return m(r).filter(function(n){return B(e,n)}).filter(function(n){return J(n)})},N=function(r,e,n){return k(F(T(r,n),e),!0,n)},U=function(r,e){return k(F(T(r),e),!1)},rr=function(r,e){return F(j(r),e)},y=function(r,e){return e===void 0&&(e=[]),e.push(r),r.parentNode&&y(r.parentNode,e),e},g=function(r,e){for(var n=y(r),t=y(e),a=0;a<n.length;a+=1){var o=n[a];if(t.indexOf(o)>=0)return o}return!1},q=function(r,e,n){var t=I(r),a=I(e),o=t[0],u=!1;return a.filter(Boolean).forEach(function(i){u=g(u||i,i)||u,n.filter(Boolean).forEach(function(f){var l=g(o,f);l&&(!u||l.contains(u)?u=l:u=g(l,u))})}),u},er=function(r,e){return r.reduce(function(n,t){return n.concat(rr(t,e))},[])},lr=function(r){var e=E(r).filter(p),n=q(r,r,e),t=new Map,a=N([n],t,!0),o=N(e,t).filter(function(u){var i=u.node;return p(i)}).map(function(u){var i=u.node;return i});return a.map(function(u){var i=u.node,f=u.index;return{node:i,index:f,lockItem:o.indexOf(i)>=0,guard:A(i)}})},nr=function(r){return r===document.activeElement},tr=function(r){return Boolean(m(r.querySelectorAll("iframe")).some(function(e){return nr(e)}))},sr=function(r){var e=document&&document.activeElement;return!e||e.dataset&&e.dataset.focusGuard?!1:E(r).reduce(function(n,t){return n||t.contains(e)||tr(t)},!1)},mr=function(){return document&&m(document.querySelectorAll("["+R+"]")).some(function(r){return r.contains(document.activeElement)})},G=function(r){return r.tagName==="INPUT"&&r.type==="radio"},ar=function(r,e){return e.filter(G).filter(function(n){return n.name===r.name}).filter(function(n){return n.checked})[0]||r},S=function(r,e){return G(r)&&r.name?ar(r,e):r},ur=function(r){var e=new Set;return r.forEach(function(n){return e.add(S(n,r))}),r.filter(function(n){return e.has(n)})},_=function(r){return r[0]&&r.length>1?S(r[0],r):r[0]},M=function(r,e){return r.length>1?r.indexOf(S(r[e],r)):e},L="NEW_FOCUS",ir=function(r,e,n,t){var a=r.length,o=r[0],u=r[a-1],i=A(n);if(!(r.indexOf(n)>=0)){var f=e.indexOf(n),l=t?e.indexOf(t):f,s=t?r.indexOf(t):-1,c=f-l,b=e.indexOf(o),d=e.indexOf(u),v=ur(e),W=v.indexOf(n)-(t?v.indexOf(t):f),C=M(r,0),D=M(r,a-1);if(f===-1||s===-1)return L;if(!c&&s>=0)return s;if(f<=b&&i&&Math.abs(c)>1)return D;if(f>=d&&i&&Math.abs(c)>1)return C;if(c&&Math.abs(W)>1)return s;if(f<=b)return D;if(f>d)return C;if(c)return Math.abs(c)>1?s:(a+s+c)%a}},or=function(r){return function(e){return e.autofocus||e.dataset&&!!e.dataset.autofocus||r.indexOf(e)>=0}},fr=function(r,e){var n=new Map;return e.forEach(function(t){return n.set(t.node,t)}),r.map(function(t){return n.get(t)}).filter(Q)},cr=function(r,e){var n=document&&document.activeElement,t=E(r).filter(p),a=q(n||r,r,t),o=new Map,u=U(t,o),i=N(t,o).filter(function(d){var v=d.node;return p(v)});if(!(!i[0]&&(i=u,!i[0]))){var f=U([a],o).map(function(d){var v=d.node;return v}),l=fr(f,i),s=l.map(function(d){var v=d.node;return v}),c=ir(s,f,n,e);if(c===L){var b=u.map(function(d){var v=d.node;return v}).filter(or(er(t,o)));return{node:b&&b.length?_(b):_(s)}}return c===void 0?c:l[c]}},dr=function(r){r.focus(),"contentWindow"in r&&r.contentWindow&&r.contentWindow.focus()},O=0,x=!1,vr=function(r,e){var n=cr(r,e);if(!x&&n){if(O>2){console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),x=!0,setTimeout(function(){x=!1},1);return}O++,dr(n.node),O--}},br=vr;export{V as F,P as a,mr as b,sr as f,lr as g,br as m};
